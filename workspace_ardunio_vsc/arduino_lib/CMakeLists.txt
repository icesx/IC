set(CMAKE_VERBOSE_MAKEFILE ON CACHE BOOL "ON" FORCE)
cmake_minimum_required(VERSION 3.0.0)
project(arduino_lib VERSION 0.1.0)
enable_language(ASM)
message(STATUS "src This is BINARY dir " ${PROJECT_BINARY_DIR})
message(STATUS "src This is SOURCE dir " ${PROJECT_SOURCE_DIR})
set(AVR_PATH /TOOLS/IDE/arduino/hardware/tools/avr/bin)
set(CMAKE_C_COMPILER ${AVR_PATH}/avr-gcc)
set(CMAKE_CXX_COMPILER ${AVR_PATH}/avr-g++)

SET(ARDUINO_LIB_HOME /ICESX/workSpaceC/IC/workspace_ardunio_vsc/arduino_lib)
message("CMAKE_CURRENT_LIST_DIR====${CMAKE_CURRENT_LIST_DIR}")
INCLUDE_DIRECTORIES(
    ${CMAKE_CURRENT_LIST_DIR}/include
    ${CMAKE_CURRENT_LIST_DIR}/libavr-base
    ${CMAKE_CURRENT_LIST_DIR}/libavr-mine
    ${CMAKE_CURRENT_LIST_DIR}/libavr-base/arduino
    ${CMAKE_CURRENT_LIST_DIR}/include/variants/mega
    ${ARDUINO_PATH}/hardware/tools/avr/lib/gcc/avr/7.3.0/include
    ${ARDUINO_PATH}/hardware/tools/avr/avr/include
    )


SET(MCU_SPEED "16000000UL")
SET(AVR_MCU "atmega2560")
add_compile_options(
    -mmcu=${AVR_MCU}
    -O2
    -Wall
    -g2
    -gstabs
    -fpack-struct
    -fshort-enums
    -ffunction-sections
    -fdata-sections
    -funsigned-char
    -funsigned-bitfields
    -fno-exceptions
    -mmcu=atmega2560
    -Wwrite-strings
)
add_definitions(
        -DF_CPU=${MCU_SPEED}
        -D__AVR_ATmega2560__
        -DARDUINO_AVR_MEGA2560
        -DARDUINO_ARCH_AVR
)

set(subs 
    libavr-base
    libavr-mine
)
foreach(sub IN LISTS subs)
    message("config subdirectory::: ${sub}")
    add_subdirectory("${sub}")
    link_directories(${PROJECT_BINARY_DIR}/${sub})
    message("workdir:::"${PROJECT_BINARY_DIR}/${sub})
endforeach (sub)
